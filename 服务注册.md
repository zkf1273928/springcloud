##eureka   面向ap  高可用和分区容错性
###服务端
1.引入pom
```xml
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-netflix-eureka-server</artifactId>
</dependency>
```
2.配置文件
```yml
server:
  port: 7001
eureka:
  instance:
    # eureka服务端的实例名称
    hostname: localhost
  client:
    # 不注册自己
    register-with-eureka: false
    # 表示自己是注册中心，不用检索服务
    fetch-registry: false
    service-url:
        defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/
```
3.主启动类添加 
```java
@EnableEurekaServer
```
###客户端
1.pom
```xml
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
</dependency>
```
2.yml配置文件
```yml
 eureka:
    client:
      # 不注册自己
      register-with-eureka: true
      # 表示自己是注册中心，不用检索服务
      fetch-registry: true
      #注册地址
      service-url:
        defaultZone: http://localhost:7001/eureka
```
3.主启动类
```java
@EnableEurekaClient
```
4。eureka有自我保护机制抱回保持集群的高度一致性更强调高可用性所以一旦一个服务die或者网络异常将服务剔除  自我保护机制下如果EurekaServer在一定时间内没有接收到某个微服务实例的心跳，就会注销该实例
##Zookeeper（c强调p）强一致性和分区容错性
1.pom
```xml
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-zookeeper-discovery</artifactId>
    <exclusions>
        <!--先排除自带的zookeeper3.5.3-->
        <exclusion>
            <groupId>org.apache.zookeeper</groupId>
            <artifactId>zookeeper</artifactId>
        </exclusion>
    </exclusions>
</dependency>
<!--添加zookeeper3.6.1版本-->
<dependency>
    <groupId>org.apache.zookeeper</groupId>
    <artifactId>zookeeper</artifactId>
    <version>3.6.1</version>
</dependency>
```
2.配置文件yml
```yml
server:
    port: 8004
spring:
  application:
    name: cloud-provider-payment
    cloud:
      zookeeper:
      #虚拟机中zookeeper的地址和端口
        connect-string: hw.mokespace.cn:2181
```        
3.主启动类
```java
@EnableDiscoveryClient
```
4安装zookeeper和一些相关命令
* 安装启动zookeeper需要关闭虚拟机防火墙systemctl stop firewall
* 查看防火墙状态systemctl status firewall
* zookeeper启动在bin目录下 ./zkService.sh start
* 查看分支./zkClient.sh
* 停止服务./zkService.sh stop
##consul （强调cp）强一致性和分区容错性
1.关于cinsul的安装
```text
window版本 默认端口8500
再解压后的文件目录用cmd打开
# 查看consul版本
consul --version
# 开发者模式启动
consul agent -dev
```
2.pom
```xml
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-consul-discovery</artifactId>
</dependency>
```
3.配置文件yml
```yml
server:
  port: 8004
spring:
  application:
    name: cloud-provider-payment
  cloud:
    consul:
      host: localhost
      port: 8500
      discovery:
        service-name: ${spring.application.name}
```        
4.主启动类
```java
@EnableDiscoveryClient
```






